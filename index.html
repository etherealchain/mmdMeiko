<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js MMD</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="mmd.css">
	</head>

	<body>
		<div id="info">
		<a href="https://github.com/etherealchain/mmdMeiko" target="_blank">Disclaimer</a><br />
		</div>
		<div id="loader">
			<div id="spinner"></div>
			<div id="progressGray">
				<div id="progressBlue">0%</div>
			</div>
			</div>
		</div>
		<script id="distanceFieldvs" type="x-shader/x-vertex">
			uniform vec3 scale;
			varying vec2 v_uv;
                
			void main()
			{
				v_uv = uv;
				float rotation = 0.0;

				vec3 alignedPosition = vec3(position.x * scale.x, position.y * scale.y, position.z*scale.z);

				vec2 pos = alignedPosition.xy;

				vec2 rotatedPosition;
				rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
				rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

				vec4 finalPosition;

				finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
				finalPosition.xy += rotatedPosition;
				finalPosition = projectionMatrix * finalPosition;
				gl_Position =  finalPosition;
			}
		</script>
		<script id="distanceFieldfs" type="x-shader/x-fragment">
			varying vec2 v_uv;
			uniform vec3 color;
			void main( void ) {

				vec2 uv = v_uv;
				// Zooms out by a factor of 2.0
				uv *= 2.0;
				// Shifts every axis by -1.0
				uv -= 1.0;
			
				// specify size of border. 0.0 - no border, 1.0 - border occupies the entire space
				float borderSize = 0.3; 
			
				float dis = length(uv);
				// size of circle in terms of uv 
				float circleRadius = 1.0 - borderSize; 
			
				// distance field, 0.0 - point is inside rectangle, 1.0 point is on the far edge of the border.
				float distanceField = length(max(dis-circleRadius,0.0) / borderSize);
				
				// calculate alpha accordingly to the value of the distance field
				float alpha = 1.0 - distanceField;
				gl_FragColor = vec4( color , alpha );
			}
		</script>

		<script src="lib/three.min.js"></script>

		<script src="lib/mmdparser.min.js"></script>
		<script src="lib/ammo.js"></script>

		<script src="lib/TGALoader.js"></script>
		<script src="lib/MMDLoader.js"></script>
		<script src="lib/OutlineEffect.js"></script>
		<script src="lib/CCDIKSolver.js"></script>
		<script src="lib/MMDPhysics.js"></script>

		<script src="lib/OrbitControls.js"></script>

		<script src="lib/Detector.js"></script>
		<script src="lib/stats.min.js"></script>
		<script src="lib/dat.gui.min.js"></script>
		<script src="lib/Tween.js"></script>

		<script src="reflection.js"></script>
		<script src="mmd.js"></script>
		
	</body>
</html>
